<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes">
  <title>日報履歴</title>
  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
  <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1/themes/redmond/jquery-ui.css" >
  <?!= HtmlService.createHtmlOutputFromFile('css').getContent(); ?>
</head>
<body>
  <nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <h1 id="dailylog">
          <span>日報履歴</span>
          <button class="btn btn-default history save-change">保存</button>
          <button class="btn btn-default location" onclick="window.top.location.href='<?= url ?>'">日報</button>
        </h1>
      </div>
    </div>
  </nav>

  <div class="mainpanel culture">
    <table class="log table">
      <thead>
        <tr>
          <th data-id="A">年月日</th>
          <th data-id="B">from</th>
          <th data-id="C">to</th>
          <th data-id="D">cc</th>
          <th data-id="E">稼働開始</th>
          <th data-id="F">稼働終了</th>
          <th data-id="G">稼働時間</th>
          <th data-id="H">実施記録</th>
          <th data-id="I">うまくいったこと</th>
          <th data-id="J">改善したいこと</th>
          <th data-id="K">その他</th>
          <th data-id="L">備考</th>
        </tr>
      </thead>
      <tbody>
<? var alpha = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'; ?>
<? var c = lastRow; ?>
<? for (var i in datas){ ?>
        <tr>
<? var rows = datas[i]; ?>
<? for (var j in rows){ ?>
          <td data-id="<?= alpha.charAt(j) + c; ?>"><?= rows[j]; ?></td>
<? } ?>
        </tr>
<? c--; ?>
<? } ?>
      </tbody>
    </table>
  </div>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
  <?!= HtmlService.createHtmlOutputFromFile('js').getContent(); ?>
  <script>
    $(window).load(function() {
      if ($(window).height() / $(window).width() < 1) {
        $('table.log th').eq(0).attr('width', '50px');
        $('table.log th').eq(1).attr('width', '200px');
        $('table.log th').eq(2).attr('width', '200px');
        $('table.log th').eq(3).attr('width', '200px');
        $('table.log th').eq(4).attr('width', '50px');
        $('table.log th').eq(5).attr('width', '50px');
        $('table.log th').eq(6).attr('width', '50px');
        $('table.log th').eq(7).attr('width', '500px');
        $('table.log th').eq(8).attr('width', '500px');
        $('table.log th').eq(9).attr('width', '500px');
        $('table.log th').eq(10).attr('width', '500px');
        $('table.log th').eq(11).attr('width', '400px');
      } else {
        $('table.log th').eq(0).attr('width', '100px');
        $('table.log th').eq(1).attr('width', '600px');
        $('table.log th').eq(2).attr('width', '600px');
        $('table.log th').eq(3).attr('width', '600px');
        $('table.log th').eq(4).attr('width', '120px');
        $('table.log th').eq(5).attr('width', '120px');
        $('table.log th').eq(6).attr('width', '120px');
        $('table.log th').eq(7).attr('width', '1000px');
        $('table.log th').eq(8).attr('width', '1000px');
        $('table.log th').eq(9).attr('width', '1000px');
        $('table.log th').eq(10).attr('width', '1200px');
        $('table.log th').eq(11).attr('width', '1000px');
      }
    });
  </script>
  <?!= HtmlService.createHtmlOutputFromFile('logjs').getContent(); ?>
</body>
</html>
